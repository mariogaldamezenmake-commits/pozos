\## üìã Descripci√≥n del Proyecto



En este proyecto de topograf√≠a se realiza un levantamiento de pozos y arquetas para posteriormente procesar la informaci√≥n en gabinete. El proceso se divide en \*\*dos pasadas en campo\*\* y un \*\*trabajo de gabinete\*\*.



---



\## üìç Primera Pasada: Levantamiento Planial√©trico y Altim√©trico



\### Objetivo



Dotar de coordenadas planialt√©ricas (X, Y, Z) a las tapas de los pozos.



\### Procedimiento



1\. \*\*Ubicaci√≥n\*\*: Se identifica cada pozo en campo

2\. \*\*Medici√≥n\*\*: Se toma un √∫nico punto en el \*\*centro de la tapa\*\* del pozo

3\. \*\*Registro\*\*: Se obtienen coordenadas X, Y, Z (cota de la tapa)

4\. \*\*Numeraci√≥n\*\*: Se asigna un identificador √∫nico a cada pozo



\### Equipo utilizado



\- Estaci√≥n total o GPS RTK

\- Prisma o antena GPS

\- Libreta de campo



\### Datos obtenidos



\- \*\*Pozo ID\*\*: Identificador √∫nico

\- \*\*X, Y\*\*: Coordenadas planialt√©ricas

\- \*\*Z (cota de tapa)\*\*: Altura de la tapa del pozo



---



\## üîç Segunda Pasada: Caracterizaci√≥n del Pozo



\### Objetivo



Obtener informaci√≥n detallada sobre las caracter√≠sticas f√≠sicas y conexiones de cada pozo.



\### Procedimiento



\### 1. Medici√≥n de la tapa



\- \*\*Di√°metro de la trapa\*\* (para pozos circulares)

\- \*\*Dimensiones\*\* (para arquetas cuadradas) ‚Üí esto tengo que preguntarlo porque no estoy seguro



\### 2. Apertura del pozo



\- Se abre la tapa para inspecci√≥n interna



\### 3. Categorizaci√≥n del tipo de agua



Se clasifica seg√∫n el tipo de agua que transporta:



\- üíß \*\*Pluvial\*\*: Aguas de lluvia

\- üöΩ \*\*Fecal / Saneamiento\*\*: Aguas residuales

\- üíß \*\*Potable\*\*: Agua de consumo

\- üåæ \*\*Acequia\*\*: Riego agr√≠cola

\- üì∂ \*\*Telecomunicaciones\*\*: Cableado

\- ‚ö° \*\*Electricidad\*\*: Red el√©ctrica

\- ‚ùì \*\*No se sabe\*\*: Casos dudosos



\### 4. Medici√≥n de profundidad de los tubos



\- Se mide la distancia vertical desde la \*\*tapa hasta la parte baja del agujero del tubo\*\*

\- Esta medida permite calcular la \*\*cota del tubo\*\*: `cota\_fondo = cota\_tapa - profundidad`



\### 5. Conteo y medici√≥n de tubos



Para cada tubo conectado al pozo:



\- \*\*Cantidad\*\*: N√∫mero total de tubos

\- \*\*Di√°metro\*\*: De cada tubo individual

\- Profundidad: distancia a la parte mas lejana de la tapa al tubo

\- \*\*Direcci√≥n\*\*: Se anota hacia d√≥nde se dirige en un croquis

\- \*\*Tipo de tubo\*\*:

&nbsp;   - üîπ \*\*Colector principal\*\*: Entrada y salida (flujo principal) ‚Üí Puede no saberse al abrir el tubo que agujero es la entrada y cual es la salida. Puede darse el caso de que solo haya un agujero de salida y no entrada en cuyo caso se trata de un pozo de arranque.

&nbsp;   - üî∏ \*\*Acometidas\*\*: Conexiones secundarias (puede haber varias)



\### 6. Registro en plano de situaci√≥n



El equipo trabaja con un \*\*plano en papel\*\* donde:



\- Anota el \*\*n√∫mero del pozo\*\*

\- Marca la \*\*profundidad del pozo para saber la cota del arenero ‚Üí duda preguntar\*\*

\- Anota el n√∫mero de tubos del pozo

\- Anota los di√°metros de los tubos

\- Anota las profundidades de los tubos

\- Dibuja \*\*l√≠neas\*\* representando los tubos con su direcci√≥n aproximada

\- Relaciona pozos: \*"el pozo 24 conecta con el pozo 25"\*



---



\## üìä Tipos de Pozos



\### Por forma de la tapa



\- üîµ \*\*Pozos\*\*: Tapa circular

\- üü™ \*\*Arquetas\*\*: Tapa cuadrada/rectangular



\### Por tipo de conexi√≥n



\- üî¥ \*\*Pozo de arranque\*\*: Solo tiene UNA salida de colector principal (sin entrada). Define el punto inicial de la red y el sentido de flujo.

\- üü™ \*\*Pozo intermedio\*\*: Tiene entrada y salida de colector

\- üü° \*\*Pozo con acometidas\*\*: Tiene conexiones secundarias adem√°s del colector



---



\## üìù Conceptos Importantes



\### Colector Principal



\- Solo puede haber \*\*UN colector principal\*\* en cada pozo

\- Tiene una \*\*entrada\*\* y una \*\*salida\*\*

\- Si solo hay flujo en una direcci√≥n sin entrada ‚Üí \*\*Pozo de arranque\*\*

\- Si no fluye agua, es dif√≠cil determinar cu√°l es entrada y cu√°l salida



\### Acometidas



\- Puede haber \*\*m√∫ltiples acometidas\*\* en un pozo

\- Son conexiones que desembocan en el colector

\- No forman parte del flujo principal



\### Sentido de flujo



\- Se determina observando el flujo de agua en el pozo

\- Los \*\*pozos de arranque\*\* ayudan a establecer el sentido de la red

\- Importante para validaci√≥n de dise√±o y normativas



---



\## üõ†Ô∏è Desaf√≠os en Campo



\### üéØ Direcci√≥n de tubos



\*\*Problema\*\*: Es complicado determinar con precisi√≥n hacia d√≥nde se dirige cada tubo.



\*\*Soluci√≥n actual\*\*:



\- El t√©cnico se mete f√≠sicamente en el pozo

\- Observa visualmente la direcci√≥n aproximada

\- Anota en el plano la conexi√≥n estimada con otros pozos



---



\## üíº Trabajo de Gabinete



Una vez recopilada toda la informaci√≥n de campo, se procede a:



1\. \*\*Digitalizaci√≥n\*\* en AutoCAD:

&nbsp;   - Creaci√≥n de polil√≠neas 3D para tubos

&nbsp;   - Ajuste de cotas Z en extremos

&nbsp;   - Inserci√≥n de bloques POZO con atributos

2\. \*\*Validaci√≥n\*\*:

&nbsp;   - Verificar conexiones entre pozos

&nbsp;   - Comprobar coherencia de cotas

&nbsp;   - Detectar errores en direcciones

3\. \*\*Generaci√≥n de entregables\*\*:

&nbsp;   - Planos de planta

&nbsp;   - Planos de perfil longitudinal

&nbsp;   - Fichas t√©cnicas por pozo

&nbsp;   - Listados y tablas



\### ü§ñ Herramientas de Automatizaci√≥n: Comando P1



Para agilizar el trabajo de gabinete se ha desarrollado el comando \*\*P1\*\* en AutoLISP para AutoCAD 2026.



\#### P1.lsp (Versi√≥n 1.0)



\*\*Prop√≥sito\*\*: Inserci√≥n de UN SOLO pozo a la vez



\*\*Flujo de trabajo\*\*:

1\. \*\*Solicita datos del pozo\*\*:

&nbsp;   - Cota de la tapa (Z de la superficie)

&nbsp;   - Profundidad del tubo (medida desde tapa hasta parte baja del agujero)

&nbsp;   - Di√°metro del tubo

&nbsp;   - N√∫mero de tubos conectados



2\. \*\*Calcula autom√°ticamente\*\*:

&nbsp;   - \`resultado = cota\_tapa - profundidad\`

&nbsp;   - Este "resultado" es la \*\*cota Z del fondo del tubo\*\*



3\. \*\*Ajusta la geometr√≠a 3D\*\*:

&nbsp;   - Permite seleccionar una polil√≠nea 3D (que representa el tubo)

&nbsp;   - Permite hacer clic cerca del extremo deseado

&nbsp;   - \*\*Modifica la coordenada Z de ese extremo\*\* al valor "resultado"

&nbsp;   - Esto garantiza que la polil√≠nea 3D termina exactamente en la cota del fondo del tubo



4\. \*\*Inserta el bloque POZO\*\*:

&nbsp;   - Inserta un bloque llamado "POZO" en el punto especificado

&nbsp;   - Rellena autom√°ticamente los atributos:

&nbsp;     - \`RESULTADO\`: Cota Z del fondo del tubo

&nbsp;     - \`DIAMETRODETUBO\`: Di√°metro del tubo

&nbsp;     - \`NUMERODETUBOS\`: Cantidad de tubos conectados

&nbsp;   - \*\*Orienta el bloque\*\* seg√∫n la tangente de la polil√≠nea en ese extremo



\*\*Ventaja\*\*: Reduce errores al calcular cotas y asigna atributos de forma autom√°tica



\#### P1\_v1.2.lsp (Versi√≥n 1.2 - ACTUAL)



\*\*Prop√≥sito\*\*: Inserci√≥n de \*\*M√öLTIPLES pozos en una sola ejecuci√≥n\*\*



\*\*Mejoras respecto a v1.0\*\*:



1\. \*\*Proceso en dos fases\*\*:

&nbsp;   - \*\*FASE 1 - Recopilaci√≥n de datos\*\*: Se solicitan los datos de TODOS los pozos consecutivamente (cota, profundidad, di√°metro, tubos)

&nbsp;   - \*\*FASE 2 - Inserci√≥n gr√°fica\*\*: Se insertan los bloques uno por uno, seleccionando polil√≠neas y extremos



2\. \*\*Validaciones integradas\*\*:

&nbsp;   - Verifica que la profundidad sea positiva

&nbsp;   - Verifica que el di√°metro sea positivo

&nbsp;   - Verifica que haya al menos 1 tubo

&nbsp;   - Emite advertencias si los valores son incorrectos



3\. \*\*Mejor manejo de errores\*\*:

&nbsp;   - Si falla la inserci√≥n de un pozo, permite continuar con los siguientes

&nbsp;   - Mensajes informativos sobre el progreso (ej: "POZO 3 de 5")

&nbsp;   - Opci√≥n de cancelar o saltar pozos individuales



4\. \*\*Experiencia de usuario mejorada\*\*:

&nbsp;   - Muestra resumen de datos antes de cada inserci√≥n

&nbsp;   - Indica progreso durante el proceso

&nbsp;   - Mensaje final con el total de pozos procesados



\*\*Ventaja principal\*\*: Permite trabajar en \*\*lote\*\*, ideal cuando se tienen muchos pozos del mismo levantamiento. Se pueden introducir todos los datos num√©ricos de una vez (mirando la libreta de campo) y luego hacer todas las inserciones gr√°ficas seguidas.



\*\*Uso recomendado\*\*: Cuando tienes 5+ pozos para digitalizar, usar v1.2 ahorra mucho tiempo al no tener que repetir el comando para cada pozo.



\#### P1\_v2.0.lsp (Versi√≥n 2.0 - CARGA AUTOM√ÅTICA DESDE CSV)



\*\*Prop√≥sito\*\*: Automatizaci√≥n completa mediante \*\*lectura de datos desde archivos CSV\*\* (PRIMERA\_PASADA.txt y SEGUNDA\_PASADA.txt)



\*\*Revoluci√≥n en el flujo de trabajo\*\*:



1\. \*\*Entrada de datos\*\*: Ya NO se escriben datos manualmente en gabinete

&nbsp;   - Los datos ya est√°n capturados en los archivos CSV de campo

&nbsp;   - El usuario solo selecciona el archivo SEGUNDA\_PASADA.txt

&nbsp;   - El sistema busca autom√°ticamente PRIMERA\_PASADA.txt en la misma carpeta



2\. \*\*Procesamiento autom√°tico\*\*:

&nbsp;   - Lee y combina ambos archivos CSV

&nbsp;   - Para cada tubo, calcula autom√°ticamente: \`cota\_tubo = cota\_tapa - prof\_tubo\`

&nbsp;   - Muestra resumen: "5 pozos cargados, 12 tubos totales"



3\. \*\*Flujo iterativo por tubo\*\*:

&nbsp;   - Para CADA tubo en SEGUNDA\_PASADA.txt:

&nbsp;     - Muestra informaci√≥n: "POZO P003 - Tubo 2/3 - Colector salida √ò30cm"

&nbsp;     - Muestra c√°lculo: "Cota tapa: 107.78m | Prof: 2.30m ‚Üí Cota tubo: 105.48m"

&nbsp;     - Solicita: Seleccionar polil√≠nea 3D

&nbsp;     - Solicita: Click en extremo de la polil√≠nea

&nbsp;     - Ajusta autom√°ticamente Z del v√©rtice a la cota calculada

&nbsp;     - Solicita: Punto de inserci√≥n del bloque POZO

&nbsp;     - Inserta bloque con atributos ya rellenos

&nbsp;     - Contin√∫a con el siguiente tubo



4\. \*\*Datos extra√≠dos de los CSV\*\*:

&nbsp;   - De PRIMERA\_PASADA.txt: ID\_POZO, X, Y, Z (cota\_tapa)

&nbsp;   - De SEGUNDA\_PASADA.txt: tipo\_agua, forma\_tapa, dim\_tapa, prof\_arenero, num\_tubo, total\_tubos, tipo\_tubo, diam\_tubo, prof\_tubo

&nbsp;   - Calculados: cota\_tubo (para ajustar Z del v√©rtice)



5\. \*\*Atributos del bloque POZO\*\* (igual que en v1.2):

&nbsp;   - \`RESULTADO\`: Cota del tubo (cota\_tapa - prof\_tubo)

&nbsp;   - \`DIAMETRODETUBO\`: Di√°metro del tubo en cm

&nbsp;   - \`NUMERODETUBOS\`: Total de tubos del pozo



\*\*Ventajas clave de v2.0\*\*:

\- ‚úÖ \*\*Cero escritura manual\*\*: Los datos ya est√°n en los CSV de campo

\- ‚úÖ \*\*Cero errores de transcripci√≥n\*\*: No hay riesgo de equivocarse al teclear n√∫meros

\- ‚úÖ \*\*Procesamiento tubo por tubo\*\*: El usuario solo hace clicks en posiciones correctas

\- ‚úÖ \*\*Trazabilidad completa\*\*: Toda la informaci√≥n viene directamente de campo

\- ‚úÖ \*\*Escalabilidad\*\*: Funciona igual con 5 tubos o 500 tubos



\*\*Uso recomendado\*\*: \*\*SIEMPRE\*\* que tengas los archivos CSV de campo. Esta es la versi√≥n definitiva para producci√≥n. Solo requiere que el t√©cnico de campo haya registrado correctamente los datos en PRIMERA\_PASADA.txt y SEGUNDA\_PASADA.txt.



\*\*Requisitos\*\*:

\- Archivos PRIMERA\_PASADA.txt y SEGUNDA\_PASADA.txt en la misma carpeta

\- Formato CSV con separador de coma (,)

\- Bloque "POZO" con atributos RESULTADO, DIAMETRODETUBO, NUMERODETUBOS



\#### P1\_v2.1.lsp (Versi√≥n 2.1 - DETECCI√ìN AUTOM√ÅTICA DE V√âRTICE) ‚≠ê ACTUAL



\*\*Prop√≥sito\*\*: Simplificaci√≥n del flujo de trabajo mediante \*\*detecci√≥n autom√°tica de polil√≠nea 3D y v√©rtice\*\*



\*\*Mejora principal respecto a v2.0\*\*:



En la v2.0, el usuario deb√≠a:

1\. Seleccionar la polil√≠nea 3D manualmente

2\. Hacer click cerca del extremo

3\. Insertar el bloque POZO



En la v2.1, el usuario solo debe:

1\. \*\*Hacer click cerca del v√©rtice\*\* ‚Üí El sistema detecta autom√°ticamente la polil√≠nea 3D m√°s cercana

2\. Insertar el bloque POZO



\*\*Nuevas funcionalidades t√©cnicas\*\*:



1\. \*\*B√∫squeda eficiente de polil√≠neas 3D\*\*:

&nbsp;   - El sistema busca entre las polil√≠neas 3D del dibujo

&nbsp;   - No requiere que el usuario identifique o seleccione cu√°l es la correcta

&nbsp;   - Detecta autom√°ticamente cu√°l tiene un v√©rtice exactamente en el punto del click

&nbsp;   - Se detiene cuando encuentra la primera coincidencia (optimizaci√≥n de rendimiento)



2\. \*\*Detecci√≥n autom√°tica de v√©rtice mediante OSNAP\*\*:

&nbsp;   - Asume que el usuario tiene OSNAP activado (Endpoint, Vertex, Node)

&nbsp;   - El click del usuario est√° exactamente en el v√©rtice gracias a OSNAP

&nbsp;   - Busca eficientemente qu√© polil√≠nea 3D tiene un v√©rtice en ese punto exacto

&nbsp;   - Usa tolerancia de 1mm para comparar coordenadas (evita errores de punto flotante)

&nbsp;   - Mucho m√°s r√°pido que calcular distancias a todos los v√©rtices



3\. \*\*Feedback informativo mejorado\*\*:

&nbsp;   - Aviso inicial: "‚ö†Ô∏è IMPORTANTE: Aseg√∫rate de tener OSNAP activado (Endpoint, Vertex, Node)"

&nbsp;   - Muestra qu√© v√©rtice fue detectado: "‚úì Detectada polil√≠nea 3D - V√©rtice #0"

&nbsp;   - Confirma cuando la Z es ajustada: "‚úì Z del v√©rtice ajustada a 105.48m"

&nbsp;   - Si OSNAP no est√° activado, avisa: "¬øTienes OSNAP activado? Verifica Endpoint/Vertex/Node"

&nbsp;   - Elimina la posibilidad de seleccionar la polil√≠nea incorrecta



\*\*Flujo de trabajo detallado\*\*:



Para cada tubo del archivo CSV:

1\. Sistema muestra informaci√≥n del tubo:

&nbsp;   - ">>> TUBO 3 de 12 <<<"

&nbsp;   - "POZO: P003 | Tubo 2/3 | Tipo: colector\_salida | √ò30cm"

&nbsp;   - "Cota tapa: 107.78m | Profundidad: 2.30m ‚Üí Cota tubo: 105.48m"



2\. Usuario hace click cerca del v√©rtice deseado



3\. Sistema detecta y procesa autom√°ticamente:

&nbsp;   - Encuentra la polil√≠nea 3D m√°s cercana

&nbsp;   - Identifica el v√©rtice m√°s cercano al click

&nbsp;   - Ajusta la coordenada Z del v√©rtice a la cota calculada

&nbsp;   - Calcula el √°ngulo de orientaci√≥n bas√°ndose en la tangente



4\. Usuario hace click para insertar el bloque POZO



5\. Sistema inserta el bloque con atributos ya rellenos y contin√∫a con el siguiente tubo



\*\*Ventajas clave de v2.1\*\*:

\- ‚úÖ \*\*Un click menos por tubo\*\*: Elimina el paso de seleccionar la polil√≠nea

\- ‚úÖ \*\*Cero errores de selecci√≥n\*\*: No hay riesgo de seleccionar la polil√≠nea equivocada

\- ‚úÖ \*\*M√°s r√°pido y eficiente\*\*: B√∫squeda optimizada por comparaci√≥n de coordenadas exactas en lugar de calcular distancias

\- ‚úÖ \*\*M√°s intuitivo\*\*: Solo hacer click en el v√©rtice (con OSNAP), el sistema detecta todo autom√°ticamente

\- ‚úÖ \*\*Escalable\*\*: Funciona igual de bien con 10 polil√≠neas que con 1000

\- ‚úÖ \*\*Mismo nivel de automatizaci√≥n\*\*: Mantiene todas las ventajas de v2.0 (lectura de CSV, c√°lculos autom√°ticos, etc.)



\*\*Uso recomendado\*\*: \*\*VERSI√ìN RECOMENDADA\*\* para todos los proyectos. Es la evoluci√≥n natural de la v2.0 con un flujo de trabajo m√°s eficiente y menos propenso a errores.



\*\*Requisitos\*\*:

\- Archivos PRIMERA\_PASADA.txt y SEGUNDA\_PASADA.txt en la misma carpeta

\- Formato CSV con separador de coma (,)

\- Bloque "POZO" con atributos RESULTADO, DIAMETRODETUBO, NUMERODETUBOS

\- Al menos una polil√≠nea 3D dibujada por cada tubo antes de ejecutar el comando

\- ‚ö†Ô∏è \*\*OSNAP activado\*\*: Es fundamental tener activados los modos Endpoint, Vertex o Node para que el click se "pegue" exactamente al v√©rtice de la polil√≠nea



\*\*Comparaci√≥n de velocidad\*\*:

\- v1.0: ~2 minutos por tubo (entrada manual de datos + selecci√≥n + inserci√≥n)

\- v1.2: ~1 minuto por tubo (entrada manual en lote + selecci√≥n + inserci√≥n)

\- v2.0: ~30 segundos por tubo (lectura CSV + selecci√≥n polil√≠nea + click extremo + inserci√≥n)

\- v2.1: ~20 segundos por tubo (lectura CSV + click v√©rtice + inserci√≥n) üöÄ



---

